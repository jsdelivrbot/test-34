<template>
    <section class="au-animate" style="margin: 1%;">
        <div style="margin-left:20px;">
            <br />
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#customers" aria-controls="customers" role="tab" data-toggle="tab">Customers</a></li>
                <li role="presentation"><a href="#parttypes" aria-controls="parttypes" role="tab" data-toggle="tab">Part Types</a></li>
                <li role="presentation"><a href="#parts" aria-controls="parts" role="tab" data-toggle="tab">Parts</a></li>
                <li role="presentation"><a href="#users" aria-controls="users" role="tab" data-toggle="tab">Users</a></li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">

                <!-- Customers -->
                <div role="tabpanel" class="tab-pane active" id="customers">
                    <br />
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            Customer Configuration
                        </div>
                        <div class="panel-body">

                            <div class="col-md-4 settings-panel">




                                <h4>Customers</h4>
                                <table class="table table-condensed">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Is Active</th>
                                            <th></th>
                                        </tr>

                                    </thead>
                                    <tbody>
                                        <tr repeat.for="c of allCustomers" id="${c.CustomerId}" click.delegate="highlightSelectedRow(c.CustomerId)">
                                            <td>${c.Name}</td>
                                            <td>${c.IsActive ? 'Yes' : 'No'}</td>
                                            <td><a click.delegate="$parent.showEditCustomerView(c)" href="#" style="text-decoration:none;color:blue;">edit</a></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="col-md-8">
                                <button if.bind="!isAddingCustomer && !isEditingCustomer" click.delegate="showAddCustomerView()" class="btn btn-primary">
                                    Add Customer
                                </button>
                                <form role="form" class="user-form">

                                    <div if.bind="isAddingCustomer || isEditingCustomer" class="panel panel-default">
                                        <div class="panel-body">
                                            <div show.bind="isAddingCustomer">
                                                <p>Add a new customer to the ProdTracker system</p>
                                                <br />
                                                <div>
                                                    <label for="customerName">Customer Name: </label><br />
                                                    <input id="customerName" type="text" name="customerName" value.bind="customerName" />
                                                    <br /><br />
                                                    <button click.delegate="addCustomer()" type="button" class="btn btn-success" style="margin-right:10px;">Add +</button>
                                                    <button click.delegate="cancelAddCustomer()" type="button" class="btn btn-default">Cancel</button>
                                                </div>
                                                <br />

                                            </div>
                                            <div if.bind="isEditingCustomer">
                                                <p>Edit an existing customer in the ProdTracker system</p>
                                                <br />

                                                <label>
                                                    Is this Customer active?<br />
                                                    <input name="customerActive" type="radio" model.bind="true" checked.bind="customer.IsActive" />&nbsp;Yes
                                                </label><br />
                                                <label>
                                                    <input name="customerActive" type="radio" model.bind="false" checked.bind="customer.IsActive" />&nbsp;No
                                                </label>
                                                <br /><br />
                                                <button if.bind="isEditingCustomer" click.delegate="editCustomer()" type="button" class="btn btn-warning" style="margin-right:10px;">Edit</button>
                                                <button click.delegate="cancelEditCustomer()" type="button" class="btn btn-default">Cancel</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>


                <!-- Part Types -->
                <div role="tabpanel" class="tab-pane" id="parttypes">
                    <br />
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            Part Type Configuration
                        </div>
                        <div class="panel-body">

                            <div class="col-md-4 settings-panel">
                                <h4>Part Types</h4>
                                <table class="table table-condensed">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr repeat.for="c of allPartTypes">
                                            <td>${c.Name}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <button if.bind="!isAddingPartType" click.delegate="showAddPartTypeView()" class="btn btn-primary">
                                    Add Part Type
                                </button>
                                <form if.bind="isAddingPartType" role="form" class="parttype-form" validate.bind="partTypeValidation" submit.delegate="addPartType()">
                                    <div class="form-group">
                                        <div class="row">
                                            <div class="col-lg-7">
                                                <label>Part Type: &nbsp;</label>
                                                <p class="help-block text-info">Enter the name of the part type</p>
                                                <input class="form-control" type="text" name="partTypeName" value.bind="partTypeName" />

                                                <br />
                                                <button type="submit" disabled.bind="partTypeValidation.isValidating"
                                                        class="btn btn-success">
                                                    ${partTypeValidation.isValidating ? 'Submitting...' : 'Add PartType'}
                                                </button>
                                                <button click.delegate="cancelAddPartType()" type="button" class="btn btn-default">Cancel</button>
                                            </div>
                                            <!--<div class="col-lg-7">
                                                <br />
                                                <label>Description: &nbsp;</label><br />
                                                <textarea cols="50" rows="4" name="partTypeDescription" value.bind="partTypeDescription"></textarea><br />
                                                <br />
                                                <button type="submit" disabled.bind="partTypeValidation.isValidating"
                                                        class="btn btn-success">
                                                    ${partTypeValidation.isValidating ? 'Submitting...' : 'Add PartType'}
                                                </button>
                                            </div>-->
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Parts -->
                <div role="tabpanel" class="tab-pane" id="parts">
                    <br />
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            Part Configuration
                        </div>
                        <div class="panel-body">

                            <div class="col-md-12 settings-panel">

                                <table class="table table-condensed">
                                    <thead>
                                        <tr style="cursor:pointer;">
                                            <th>
                                                <a click.delegate="sortTable('CustomerName')">
                                                    Customer <span show.bind="orderByField == 'CustomerName'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>
                                            <th>
                                                <a click.delegate="sortTable('PartTypeName')">
                                                    Part Type <span show.bind="orderByField == 'PartTypeName'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>
                                            <th>
                                                <a click.delegate="sortTable('PartNumber')">
                                                    Part # <span show.bind="orderByField == 'PartNumber'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>
                                            <th>
                                                <a click.delegate="sortTable('TraySize')">
                                                    Tray Size <span show.bind="orderByField == 'TraySize'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>

                                            <th>
                                                <a click.delegate="sortTable('HasAutoGeneratedSerial')">
                                                    Are Serials Imported? <span show.bind="orderByField == 'HasAutoGeneratedSerial'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>
                                            <th>
                                                <a click.delegate="sortTable('SerialNumberLength')">
                                                   Required Serial Length <span show.bind="orderByField == 'SerialNumberLength'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>
                                            <th>
                                                <a click.delegate="sortTable('IsActive')">
                                                    Is Active <span show.bind="orderByField == 'IsActive'">
                                                        <span show.bind="!reverseSort"><i class="fa fa-caret-up"></i></span>
                                                        <span show.bind="reverseSort"><i class="fa fa-caret-down"></i></span>
                                                    </span>
                                                </a>
                                            </th>
                                            <th></th>
                                            <!--<th></th>-->
                                        </tr>

                                    </thead>
                                    <tbody>
                                        <tr repeat.for="p of allParts" id="${p.PartId}" click.delegate="prepareEditPart(p.PartId)" class="pointer">
                                            <td>${p.CustomerName}</td>
                                            <td>${p.PartTypeName}</td>
                                            <td>${p.PartNumber}</td>
                                            <td>${p.TraySize}</td>
                                            <td>${p.HasAutoGeneratedSerial ? 'Yes' : ' no'}</td>
                                            <td>${p.SerialNumberLength}</td>
                                            <td>${p.IsActive ? 'Active' : '-'}</td>

                                            <!--<td class="pointer schott-orange" click.delegate="prepareEditPart(p)">edit</td>-->
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="col-md-12 panel" style="border-top:1px solid #000;">

                                <br />
                                <button show.bind="!editMode && !showPartForm" click.delegate="showPartFormView()" class="btn btn-primary">
                                    Add Part
                                </button>

                                <div if.bind="showPartForm">
                                    <h2 style="margin-left:5px;" class="schott-orange">Part</h2>
                                    <form role="form" class="parts-form" validation.bind="partValidation"
                                          submit.delegate="!editMode ? addPart() : editPart()">

                                        <div class="form-group">

                                            <div class="col-xs-4 col-md-3">
                                                <p class="text-danger">All fields are required</p>
                                                <label>Customer:</label>
                                                <br />
                                                <select required value.bind="selectedCustomerId"
                                                        change.delegate="getCustomer()" class="select-option-width">
                                                    <option value="">-- select customer --</option>
                                                    <option model.bind="c.CustomerId" repeat.for="c of allCustomers" value.bind="c.CustomerId">
                                                        ${c.Name}
                                                    </option>
                                                </select>
                                                <br />
                                                <br />
                                                <label>Part Type:</label><br />
                                                <select  required value.bind="selectedPartTypeId" class="select-option-width">
                                                    <option value="">-- select part type --</option>
                                                    <option model.bind="p.PartTypeId" repeat.for="p of allPartTypes" value.bind="p.PartTypeId">
                                                        ${p.Name}
                                                    </option>
                                                </select>
                                                <br />
                                                <br />
                                                <label>Part Number:</label><br />
                                                <input required style="width:180px;" class="form-control" type="text" name="partNumber" value.bind="partNumber" />
                                                <br />
                                                <label>Tray Size:</label>
                                                <p class="text-info">How many parts are in a <b>full</b> tray?</p>
                                                <input required class="form-control" type="number" min="1" name="traySize" value.bind="traySize" style="width:75px;" />

                                                <br />
                                                <label for="hasAutoGeneratedSerial">
                                                    Are Serial Numbers imported?
                                                </label>
                                                <p class="text-info">
                                                    System will verify serial numbers against database (e.g., inverters)
                                                    <br />
                                                <p>
                                                    <div>
                                                        <label class="radio control-label">
                                                            <span style="padding-right:24px;">Yes</span>
                                                            <input required model.bind="true" type="radio" checked.bind="hasAutoGeneratedSerial"
                                                                   name="hasAutoGeneratedSerial" value="true">
                                                        </label>

                                                        <label class="radio control-label">
                                                            <span style="padding-right:27px;">No</span>
                                                            <input required model.bind="false" type="radio" checked.bind="hasAutoGeneratedSerial"
                                                                   name="hasAutoGeneratedSerial" value="false">
                                                        </label>

                                                    </div>

                                                    <br />

                                                    <label>Required Serial Length:</label>
                                                <p class="text-info">What is the required length of the serial number? (e.g., if the serial is like 12345, the length would be 5).</p>
                                                <input required class="form-control" type="number" name="serialNumberLength" value.bind="serialNumberLength" maxlength="2" max="99" size="2" style="width:75px;" />
                                                <br />

                                                <br />
                                                <div if.bind="editMode" style="margin-bottom:20px;">
                                                    <label for="isActive">
                                                        Is Active:

                                                    </label>
                                                    <br />
                                                    Check this box to set this part "Active"
                                                    <input model.bind="isActive" type="checkbox" name="isActive" checked.bind="isActive" />
                                                </div>
                                                <button if.bind="!editMode" type="submit" class="btn btn-success">${partValidation.isValidating ? 'Submitting...' : 'Add New Part #'} </button>

                                                <button if.bind="editMode" type="submit" class="btn btn-warning">${partValidation.isValidating ? 'Submitting...' : 'Save Changes'} </button>
                                                <button click.delegate="cancelEdit()" type="button" class="btn btn-default">Cancel </button>
                                                <br />
                                                <br />
                                                <br />
                                                <br />
                                             
                                                <button if.bind="editMode" click.delegate="deletePart()" type="button" class="btn btn-danger">
                                                    Make Part Inactive
                                                </button>
                                               
                                            </div>


                                            <div class="col-xs-12 col-md-9 col-lg-9 panel panel-default">
                                                <h4 class="panel-heading">Sample layout for Tray</h4>
                                                <p class="help-block text-info">
                                                    Please set the following parameters to the dimensions of your physical tray.
                                                    <br />
                                                <p>
                                                    <div style="padding-top:20px;">

                                                        <div class="form-group col-xs-4 col-md-2">
                                                            <label class="control-label">Columns:</label>
                                                            <input id="columns" class="form-control" min="1" change.delegate="updateColumns($event)" 
                                                                   type="number" name="columns" style="width:75px;" />
                                                        </div>
                                                        <div class="form-group col-xs-4 col-md-2">
                                                            <label>Rows:</label>
                                                            <input id="rows" class="form-control" min="1" change.delegate="updateRows($event)" 
                                                                   type="number" name="rows" style="width:75px;" />
                                                        </div>
                                                        <div class="form-group col-xs-4 col-md-4">
                                                            <label>Is Staggered:</label>
                                                            <br/>
                                                            <span>
                                                                <label class="radio-inline">                                                        
                                                                    <input model.bind="true" type="radio" checked.bind="isStaggered"
                                                                           name="isStaggered" value="true">Yes
                                                                </label>
                                                                <label class="radio-inline" >                                                                   
                                                                    <input class="radio-inline" model.bind="false" type="radio" checked.bind="isStaggered"
                                                                           name="isStaggered" value="false">No
                                                                </label>
                                                            </span>
                                                        </div>
                                                    </div>

                                                    <div class="col-md-12" style="padding-bottom:200px; overflow:scroll;">
                                                        <div id="trayDiv" style="margin-top:5%;">
                                                            
                                                            <h5>Example:</h5>
                                                            <div repeat.for="j of rows" style="zoom: 80%">
                                                                <div id="row" class.bind="(j % 2) == 0 && $parent.isStaggered ? 'staggered-odd' : ''" class="col-xs-12 background">

                                                                    <div id="cell" repeat.for="i of columns" class="col-xs-1 col-md-1" style="padding:6px;width:100px;">

                                                                        <div class="input-group input-group-sm">
                                                                            <span class="input-group-addon" id="sizing-addon1">${(i + (j * $parent.$parent.columns)) + 1}</span>
                                                                            <input disabled="disabled"
                                                                                   type="text"
                                                                                   class="form-control serial-text"
                                                                                   aria-describedby="sizing-addon1">

                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>

                                            </div>

                                        </div>

                                    </form>


                                </div>



                            </div>



                        </div>
                    </div>
                </div>


                <!-- Users -->
                <div role="tabpanel" class="tab-pane" id="users">
                    <br />
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            Users
                        </div>
                        <div class="panel-body">
                            <h5><i class="glyphicon glyphicon-star admin-star"></i>&nbsp;The following are <b>Active</b> users in the system:</h5>
                            <br />
                            <div class="row" style="margin:1%;">
                                <ul repeat.for="user of users" class="no-bullet">
                                    <li style="display:inline-block;">

                                        <div class="panel">
                                            <b title="Last login: ${user.LastLoginDate | dateFormat: 'MM/DD/YYYY'}">

                                                <i class="glyphicon glyphicon-user"></i> ${user.UserName}
                                            </b>
                                            <br />
                                            Default Part Type:
                                            <span if.bind="user.DefaultPartType" class="schott-orange">${user.DefaultPartType}</span>
                                            <span if.bind="!user.DefaultPartType" class="schott-orange">All</span>

                                            <br />

                                            <span show.bind="getCurrentUser().role[1] === 'admin'">
                                                <span>
                                                    <br />
                                                    <select class="form-control" value.bind="selectedUserDefaultPartTypeId"
                                                            change.delegate="updateUsersDefaultPartType(user)"
                                                            style="width: 250px;">
                                                        <option value="">-- change default part type --</option>
                                                        <option value="0">All</option>
                                                        <option model.bind="p.PartTypeId" repeat.for="p of allPartTypes" value.bind="p.PartTypeId">
                                                            ${p.Name}
                                                        </option>
                                                    </select>
                                                    <br /><br />

                                                </span>


                                            </span>
                                        </div>
                                    </li>




                                </ul>

                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>






    </section>
</template>